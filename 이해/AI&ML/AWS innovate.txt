
산업자산을 위한 기계학습
- 산업용자산을 위해 만들어진 기계학습 모델
- 자산종류와 크게 관련이 없음.
- 기계학습 플로우가 자동화되어있음. 덕분에 전문가의 도움 없이
쉽게 할 수 있다.
정상적인 동작을 학습해두고 범주를 벗어가면 비정상 동작으로 파악

Lookout for vision 
비전 기술로 품질검사를 자동화.
품질 비용 1~5 결함 재작업, 폐기, 소비자 반품등.
기존방식 = 육안검사 인라인검사 -> 최종 결과물 검사 방식
유연, 민첩하지만 처리량 한계존재. 개인별 기준의 차이로 인한 일관성 저하
컴퓨터비전 인라인검사 -> 오프라인 검사
빠르고 반복가능, 비용절감 하지만 높은 초기비용 유연성이 떨어지고 적용범위가 협소하다.

하지만 품질, 제품공성 향상, 운영비용 감소, 민첩성 증가 지속적 정확도 가 보장
다양한 조건에서도 식별가능 기계학습 전문가 없이도 이용가능.
이러한 점들이 위의 문제점을 해결해 줄 수 있다.

이미지를 S3에 저장하고 Lookout은 이 이미지를 이용 학습. 모델을 만들고
모델을 이용해 결함 확인.

기능 5개
1. 제조라인 통합: API식으로 기존 제조라인에 통합가능.
2. 대시보드 뷰: 대시보드를 통해 생산라인, 프로세스별로 식별가능
3. 레이블링 간략화: 머신러닝에 가장 힘든 레이블링 작업이 단순해진다. 특히 한번에 여러 이리지를
선택하여 처리가능.
4. 빠른 평가: 테스트 데이터셋을 자동 생성하여 빠르게 평가 가능하다.
5. 테스트 감지 및 피드백: 피드백을 제공하여 결함 탐지 모델 개선을 줄 수 있다.

Amazon Rekognition

이미지 레이블링을 박스를 쳐가며 수동으로 해야되는 불편함 존재
하지만 품질은 더 우수.

S3버킷에 이미지 업로드 레이블링 Manifast에 추가의 과정으로
모델 생성

레이블링의 과정을 SageMaker ground Truth를 이용해서 개선 가능
퍼블릭 인력소싱까지 가능한 서비스 기계를 이용한 레이블링까지 지원.

데이터를 테스트 데이터와 학습데이터로 나누고 학습.

학습데이터의 80퍼센트만 학습에 이용 20프로는 모델 성능평가
평가는 Precision, Recall, F1 score를 이용한다.

학습 데이터의 조명, 해상도, 배경도 학습에 중요한 영향을 끼친다.

모델이 어느정도 납득가능하면 재학습 파이프라인을 생성해준다.
피드백 루프를 이용해 A2I에서 제공하는 포탈에서 레이블을 지정.
그 결과를 데이터셋에 저장하고 기존 데이터셋과 같이 학습.
기존모델보다 좋을경우 배포.

PPE detection의 경우 배포없이 API형태로 이용가능.
이 기능은 Head cover, Face cover 등을 탐지가능하고 이를 보호장구 확인에 이용할 수 있다.

AI
Amazon personalize
개인화 추천!
재생화면, 추천순위 등의 VOD서비스 내의 개인화
아마존은 개인화에 어떤 경험? 웹이랑 비디오에서 개인화에 관심을 가지고 연구해온 경험 존재
개인화는 검색성능, 결제, 사용자만족도, 매출향상에 영향이 잇다.

세션기반의 추천을 제공해서 유저취향 변화에도 민감하게 대응 가능.
관련 인프라 관리 필요x
개인화 방식
유사아이템 추천. - 제품의 메타데이터 이용
아이템 리스트 준비 -> 랭킹모델 추론함수 이용 -> 개인화된 랭킹 리스트 제공
사용자는 머신러닝 지식없이 API형태로 이용 가능

데이터파악 -> 데이터필드 선택 -> 하이퍼 파라미터 선택 -> 추론 -> 평가 반복해서 모델생성
* 세션기반 실시간 추천. 앞서 다른걸 많이 봤어도 현 세션에서 구두를 봤으면 구두 중심 추천

Amazon Personalize 콘솔창에서 이를 활용가능

--------------------------------------------------------------------------------------------------------------------

AWS 기계학습

머신러닝에 대한 프레인워크나 인프라를 지원해준다. GPU나 대용량 인스턴스로 이를 지원하며 모델훈련
배포 서비스까지 원스톱으로 지원.
비전, 음성인식, 합성 등의 기능을 API로도 제공.

기계학습을 위한 견고한 기초 제공. 딥러닝 프렘워크 ex 텐서플로우 등을 이용해 pytorch
학습 데이터 샘플을 학습. 이후 실제 테스트데이터로 확인하는 모델 추론.

머신러닝에도 다양한 프레임 워크를 사용하느 것이 추세.
AWS는 이런 다양한 프레임워크에 자유를 줌. R5메모리 인텐시브한 인스턴스 + GPU인스턴스. A100등 을 제공
여러 추가된 인스턴스 타입이 존재.

1. 인스턴스
그중 pd4 가장 고성능의 기계학습 인스턴스. GPU4000개까지 확대가능.
p3대비 최대 3배빠름.

2.구현을위한 빠른길
End to End로 만들어진 완전처리형 학습 서비스를 제공.
모델훈련 추적 디버깅 최적화가 원클릭.
서비스도 오토스케일링.
통합 IDE환경 콘솔을 제공해서 웹을 통해 클릭함으로써 인프라를 몰라도
우리가 학습할 수 있는 블랙박스형식. + 모니터링 모델평가 기능까지.
맞춤형 + 자동화. Sagemaker는 편향감지기능도 존재. 150개 이상의 모델 제공
머신러닝 데브옵스 손쉽게 관리 + 자원 모니터링.
데브옵스 모델로 CD/CI방식 제공. => 머신러닝 개발자와 클라우드 데브옵스간 쉬운 협업지원

3. 모든 빌더에게 기계학습 능력 확대
일반 개발자, 데이터 분석가, 현업에도 머신러닝 능력을 확대 적용가능
어플리케이션에 모델적용 데이터 사이언티스트 => 훈련 => DB에서 데이터 읽는 코드 + API(학습모델) => 출력
이러면 개발자, 사이언티스트간 협업 필요. 이걸 개선하고자 SQL만 던지면 학습된 데이터 추출해서 결과를 보완 Aurora ML이라는 서비스.

4. 현실적인 비즈니스 문제 해결
다양한 요구에 맞춤 학습모델 제공. 개인화에도 많은 경험으로 서비스 제공.
비즈니스 데이터 이상탐지, 인프라 운영 데이터 이상탐지 드응 다양한형태의 이상탐치 가능
센서를 통해 기계 이상탐지(한국 제조기업 참여)
모니트론 = 센서 + 데이터 전송장치로 구성. 센서를 설비에 붙이면 앱으로 이상탐지 가능
다양한 환경 이상탐지를 위한 다양한 서비스 또한 제공.
클라우드를 위한 DevOps 관련 기능등도 다수 존재 ex DevOps Guru
Look out for vision = 비전기술 이용해서 문제탐지
Panorama Appliance 를 룩업포 비전과 병합적으로 활용하면 장점이 많다
Lookout for metrics = 데이터 업로드 => 데이터 셋 탐지 => 이상 감지
lamda함수 이상탐지 및 위치와 알람들을 줄 수 있는 기능도 있음

5. 지속적인 학습 기회 제공
deepRacer = 강화학습용. 자율레이싱 학습도구 등.
손쉽게 기계학습을 배울 수 있는 툴과 메뉴얼 교육등이 존재.
온라인 교육과 자격증 제도도 존재한다.

-----------------------------------------------------------------------------------------------

Amazon Lookout for Equipment 및 Amazon Lookout for Vision

- Amazon Lookout for Equipment

유지보수 방법 발전: 고장시 수리(다운타임 존재) -> 정기적 유지보수(비용커짐) -> 통계기반 예측
-> 자동화.
Predcriptive 방식은 공정라인 정지 리스크 감소, 품질보증, 기기사용기간 증가.

하지만 기계학습 적용이 어렵다는 것이 단점.

해결책. 
적합한 적용분야인지 확인. 
다양한 자산과 데이터 인프라의 양과 질이 충분한가.
시간 규모 능력이 되는가.
위의 3가지에 대해 진지하게 고민하고 적용해야 한다.

산업현장에 사용되는 펌프에 RPM 유량 측정 센서를 두고 정상범위를 벗어난
데이터들을 감지 효율성이나 비정상 동작에 대한 경고를 하면 된다.
이를 모니터링하기 쉽도록 그래프나 가시적인 결과물로 보여준다.

운용환경이 가변적인 경우 적합하지 않음.

- Amazon Rekognition으로 컴퓨터 비전 서비스 만들기

머신러닝 전문지식 없이도 API 호출 방식으로 딥러닝 기술을 사용하여 이미지 및 비디오 분석을 추가할 수 있음.
이미지 분석은 사물, 장면, 액티비티, 얼굴탐지 분석, 유명인사 인식, 폭령, 성적인 컨텐츠 탐지.

비디오는 인물트래킹, 영상 통계등.

원하는 API와 이미지를 보내면 Rekognition이 분석해서 반환.
AWS 비전 전문가들도 계속해서 모델 개선중.

제품분류를 Rekognition으로, 자동차 모델명 연식, 회사 로고 인식 등을
할 수 있는가?

개인화된 모델을 사용하고 싶으면 즉 개인화된 모델을 만들어서 사용해야 된다.
1. SageMaker를 이용하면 된다. -> 사내 머신러닝 담당조직 필요.
2. Marketplace에서 비전모델을 구매.
3, Custom Labels 이용
   ㄴ 이미지에 레이블링을하고 AutoML을 이용에 학습. 여러모델로 동시에 학습.
   Pre Train 데이터 이용해서 모델 선택 후 마저 학습. 배포까지 원클릭으로.

Data Augmentation 이용해서 적은 샘플 사진을 여러 방법으로 늘려서
학습 데이터를 늘릴 수 있다. Data Augmentation을 위한 여러 오픈 소스또한 존재한다.

Object dedection엔 바운딩 박스, 이미지 레벨 Labeling 방식은 분류에 적합.
레이블링된 데이터는 S3버켓으로 보내서 학습에 이용.

SageMaker Ground Truth 이용하면 ML훈련용 데이터 레이블을 쉽게 할 수 있음.

모델마다 False negative(FN)이 낮은게 중요할 수 있고 FP가 낮은게 중요할 수 있다.

-----------------------------------------------------------------------------------------------

시계열 데이터 예측 지원 서비스

Amazon Forecast = 웹환경 위에서 클릭 몇번으로 학습된 모델을 제공. ML에 대한 기반이 없는
조직일 수록 효과가 크다. AutoML을 이용해서 최적의 모델을 만들어냄. Automl은 wQL을 이용해서
모델을 평가하고 가장 좋게 평가된 모델을 이용해서 학습 결과 모델을 도출해낸다.
학습 시간이 길고 예측 최대 갯수가 제한적이며 시각화가 불편하다.
하지만 전무적인 지식없이 최적의 알고리즘을 찾아주고 EDA과정이 불필요하다는 장점이 있다.

SageMaker = 조직내에 ML에 전문적인 부서가 존재할 경우 효과적이다. 학습, 평가, 재학습 배포의 파이프라인을
직접 조작하여 가장 효율적인 모델을 도출해 낼 수 있다. 고객환경에 좀더 최적화된 모델을 선택할 수 있다.


Gluon TS = 알고리즘부터 개발이 가능한 MXNet(ML 프레임워크)위에서 동작하는 라이브러리
오픈소스 기반이라 알고리즘을 가져다 쓸 수도 있음. SageMaker에서 사용할 수 있는 시계열모델을 위한 오픈소스 툴킷.
빠르게 최신의 딥러닝 모델 구축, 테스트가 가능하다.

시계열 예측에 자주 사용되는 알고리즘 3개
사진 5.

------------------------------------------------------------------------------------------------------------------------------------------------

Amazon Personalize를 이용한 빠르고 정확한 추천서비스 구축

사용자 경험(UX)에 기반한 개인화를 통해 검색 성능 ,결제 ,사용자 만족도, 매출 등의 향상에 영향을 줌
그래서 필요.

Amazon Personalize란? 머신러닝에 대한 전문지식이 없어도 데이터만 있으면 손쉽게 맞춤형 머신러닝 추천모델을 제공해주는 서비스이다.
또한 여러 세션기반 상품 추천 알고리즘을 제공해 준다.
유사 아이템, 제품추천, 알림 이메일등의 개인화 서비스에 이용가능.
제품의 메타데이터를 활용.
또한 Reranking에도 쓰임 가져온 아이템 리스트의 순서를 재배열 해줌.

인터랙션, 유저, 아이템 3개의 데이터를 제공해주면 하이퍼파라메터, 알고리즘을 이용하여 개인화 추천 API를 제공해줌.
사용자는 복잡한 ML과정에 대해 알 필요가 없다.

디테일하게 보면 데이터 판단, 유의미 데이터를 뽑고 하이퍼파라메터로 알고리즘 선정 모델학습의 과정을 거친다.

세션기반 상품추천은 과거 데이터보다 현재 세션에서 확인한 물품과 유사한 상품을 추천해주는 방식.

단순한 룰기반 추천 혹은 데이터양이 모자르다면 적용하기 힘듬.
그밖으 대부분의 개인화 시나리오에 대해서는 기원이 가능하다.

구성방법 : 콘솔에서 보면 크게 데이터 가져오기, 모델 학습, 솔루션 생성의 3가지 단계로 이루어진다.
이 모든 방식이 한화면에서 클릭 몇번으로 수행된다.

인터렉션 데이터가 학습에 필수적이다. 평점, 언제, 어디서, 누가 이러한 데이터를 말한다.
이외에 유저의 메타데이터 아이템에 대한 메타데이터는 추가적인 데이터로 본다.
이런 데이터들을 S3버킷에 올린다.

CSV형태의 자료를 주면 JSON형태로 저장.
그리고 알고리즘을 선택. 유저 개인화, 유사제품, 개인화 랭킹중 하나를 선택.

User personalization알고리즘이 대부분의 경우 사용된다.

이렇게 솔루션이 완선되었으면 배포를 하면된다. 배포를 하면 캠페인이라는 이름으로 생성이되고
이러한 켐페인은 매번 자동업데이트하거나 API를 통해 수동업데이트 할 수있다.

레시피 종류별로 사용하는 API가 다르다 이 점을 유의하자. 이 API를 이용해서 실제 어플리케이션에서
사용이 가능하다.

실시간 정보를 보는 사용자가 있을때 그 정보를 바탕으로 호완되는 제품이나 관련 상품등을 담아 페이지를
업데이트 해 줄 수 있다.
또한 검색시 개인화된 검색 결과를 제공해 줄 수 있다.

PPE?
캠페인은 필터링, 탐색, 추천등에 쓰이며 이는 발전된 형태의 개인화된 서비스를 제공하는데 필수적이다.

